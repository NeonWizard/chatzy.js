<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>chatzy.js Blog</title>
        <link>https://neonwizard.github.com/chatzy.js/blog</link>
        <description>chatzy.js Blog</description>
        <lastBuildDate>Fri, 05 Aug 2022 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Reverse Engineering Chatzy]]></title>
            <link>https://neonwizard.github.com/chatzy.js/blog/reverse-engineering-chatzy</link>
            <guid>reverse-engineering-chatzy</guid>
            <pubDate>Fri, 05 Aug 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Login]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="login">Login<a class="hash-link" href="#login" title="Direct link to heading">​</a></h2><p>Logging in is simple - just a few constants, alongside the username and password for the user.
The response body is just some code which I'm assuming just redirects the page to the homepage.
The only interesting part of the response is the <code>set-cookie</code> header, particularly the ChatzyUser cookie.
This ChatzyUser cookie is the user's email address appended with an ampersand and then some random characters.
Interestingly - this cookie can be omitted from the call to join a room.
Somehow it's used to fetch the API token, which is currently X3813 sent via an injected script tag.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="join-room">Join Room<a class="hash-link" href="#join-room" title="Direct link to heading">​</a></h2><p>Logging in is also fairly straightforward. A few constants, some user configuration (nickname, color), and room information.
Interesting to note, as mentioned in the 'Login' section, the ChatzyUser cookie can be omitted without affecting the call.
This is because authentication is done by (currently) X3813 in the post body, which is retrieved from an injected script tag.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="x3813">X3813<a class="hash-link" href="#x3813" title="Direct link to heading">​</a></h2><p>This is retrieved from an injected script tag. It's unknown why this is the behavior, but seems to be generated into the webpage
whenever the ChatzyUser cookie is sent in a GET request for page HTML. Assumed to be used for all authenticated POST requests.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="chatzyuser">ChatzyUser<a class="hash-link" href="#chatzyuser" title="Direct link to heading">​</a></h2><p>This is retrieved from a cookie set when logging in. This is assumed to be used for all authenticated webpage GET requests.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="websocket">Websocket<a class="hash-link" href="#websocket" title="Direct link to heading">​</a></h2><p>There is a websocket which is literally only there for receiving data in realtime.
Messages and data are still sent with POST requests.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flow">Flow<a class="hash-link" href="#flow" title="Direct link to heading">​</a></h2><p>Login</p><ul><li>&lt;- username, password</li><li>-&gt; ChatzyUser cookie</li></ul><p>Homepage Fetch</p><ul><li>&lt;- ChatzyUser cookie</li><li>-&gt; X3813 variable in injected script tag</li></ul><p>Join Room</p><ul><li>&lt;- X3813 script variable</li><li>-&gt; X7910 room access token</li></ul><p>Send Message</p><ul><li>&lt;- X7910 room access token</li></ul>]]></content:encoded>
        </item>
    </channel>
</rss>