"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[672],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),h=c(n),d=o,m=h["".concat(l,".").concat(d)]||h[d]||p[d]||i;return n?r.createElement(m,a(a({ref:t},u),{},{components:n})):r.createElement(m,a({ref:t},u))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},860:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var r=n(7462),o=(n(7294),n(3905));const i={slug:"reverse-engineering-chatzy",title:"Reverse Engineering Chatzy",authors:{name:"NeonWizard",title:"Core Developer"},tags:[]},a=void 0,s={permalink:"/chatzy.js/blog/reverse-engineering-chatzy",source:"@site/blog/2022-08-05-reverse-engineering-chatzy.md",title:"Reverse Engineering Chatzy",description:"Login",date:"2022-08-05T00:00:00.000Z",formattedDate:"August 5, 2022",tags:[],hasTruncateMarker:!1,authors:[{name:"NeonWizard",title:"Core Developer"}],frontMatter:{slug:"reverse-engineering-chatzy",title:"Reverse Engineering Chatzy",authors:{name:"NeonWizard",title:"Core Developer"},tags:[]}},l={authorsImageUrls:[void 0]},c=[{value:"Login",id:"login",level:2},{value:"Join Room",id:"join-room",level:2},{value:"X3813",id:"x3813",level:2},{value:"ChatzyUser",id:"chatzyuser",level:2},{value:"Websocket",id:"websocket",level:2},{value:"Flow",id:"flow",level:2}],u={toc:c};function p(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"login"},"Login"),(0,o.kt)("p",null,"Logging in is simple - just a few constants, alongside the username and password for the user.\nThe response body is just some code which I'm assuming just redirects the page to the homepage.\nThe only interesting part of the response is the ",(0,o.kt)("inlineCode",{parentName:"p"},"set-cookie")," header, particularly the ChatzyUser cookie.\nThis ChatzyUser cookie is the user's email address appended with an ampersand and then some random characters.\nInterestingly - this cookie can be omitted from the call to join a room.\nSomehow it's used to fetch the API token, which is currently X3813 sent via an injected script tag."),(0,o.kt)("h2",{id:"join-room"},"Join Room"),(0,o.kt)("p",null,"Logging in is also fairly straightforward. A few constants, some user configuration (nickname, color), and room information.\nInteresting to note, as mentioned in the 'Login' section, the ChatzyUser cookie can be omitted without affecting the call.\nThis is because authentication is done by (currently) X3813 in the post body, which is retrieved from an injected script tag."),(0,o.kt)("h2",{id:"x3813"},"X3813"),(0,o.kt)("p",null,"This is retrieved from an injected script tag. It's unknown why this is the behavior, but seems to be generated into the webpage\nwhenever the ChatzyUser cookie is sent in a GET request for page HTML. Assumed to be used for all authenticated POST requests."),(0,o.kt)("h2",{id:"chatzyuser"},"ChatzyUser"),(0,o.kt)("p",null,"This is retrieved from a cookie set when logging in. This is assumed to be used for all authenticated webpage GET requests."),(0,o.kt)("h2",{id:"websocket"},"Websocket"),(0,o.kt)("p",null,"There is a websocket which is literally only there for receiving data in realtime.\nMessages and data are still sent with POST requests."),(0,o.kt)("h2",{id:"flow"},"Flow"),(0,o.kt)("p",null,"Login"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"<- username, password"),(0,o.kt)("li",{parentName:"ul"},"-> ChatzyUser cookie")),(0,o.kt)("p",null,"Homepage Fetch"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"<- ChatzyUser cookie"),(0,o.kt)("li",{parentName:"ul"},"-> X3813 variable in injected script tag")),(0,o.kt)("p",null,"Join Room"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"<- X3813 script variable"),(0,o.kt)("li",{parentName:"ul"},"-> X7910 room access token")),(0,o.kt)("p",null,"Send Message"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"<- X7910 room access token")))}p.isMDXComponent=!0}}]);